#Requires AutoHotkey v2.0

#Include "../DefaultMap.ahk2"
#Include "../Types.ahk2"
#Include "../MatchGroup.ahk2"

class ezÎ© extends Component {
	Static init() {
		For replacement In ezÎ©.case_insensitive_replacements {
			match := replacement[1]
			replacement := replacement[2]
			match_groups[Trim].case_insensitive_matches[match] := replacement
		}
		For replacement In ezÎ©.case_sensitive_replacements {
			match := replacement[1]
			replacement := replacement[2]
			match_groups[Trim].exact_matches[match] := replacement
		}
	}
	
	Static doubleReplacer(lower, upper) {
		Static double_length_p_1 := StrLen("double") + 1
		replacer(match, whole_text) {
			trimmed := match[1]
			If (IsUpper(SubStr(trimmed, 1, 1)) Or IsUpper(SubStr(trimmed, double_length_p_1, 1))) {
				Return upper
			} Else {
				Return lower
			}
		}
		Return replacer
	}
	
	Static bracketReplacer(opening, closing) {
		back_keys := StrRepeat("{Left}", StrLen(closing))
		bracketInserter() {
			SendText(opening . closing)
			Sleep(200)
			Send(back_keys)
		}
		replacer(match, whole_text) {
			Return bracketInserter
		}
		Return replacer
	}
	
	;#region replacements
		Static card_suites := [
			["herc"    , "â™¥"],
			["karo"    , "â™¦"],
			["pik"     , "â™ "],
			["tref"    , "â™£"],
			["hearts"  , "â™¥"],
			["diamonds", "â™¦"],
			["spades"  , "â™ "],
			["clubs"   , "â™£"],
		]
		Static arrows := [
			["<=>", "â‡”"],
			["=>", "â‡’"],
			["<=", "â‡"],
			
			["<->", "â†”"],
			["->", "â†’"],
			["<-", "â†"],
		]
		Static punctuation := [
			["...", "â€¦"],
			["dagger", "â€ "],
		]
		Static O := [
			["/o", "Ã¸"],
			["o/", "Ã¸"],
			["/O", "Ã˜"],
			["O/", "Ã˜"],
		]
		Static diacritics := [
			["ae", "Ã¦"],
			["Ae", "Ã†"],
			["AE", "Ã†"],
			
			["oe", "Å“"],
			["Oe", "Å’"],
			["OE", "Å’"],
			
			["nj", "ÇŒ"],
			["Nj", "Ç‹"],
			["NJ", "ÇŠ"],
			
			["lj", "Ç‰"],
			["Lj", "Çˆ"],
			["LJ", "Ç‡"],
			
			["dÅ¾", "Ç†"],
			["DÅ¾", "Ç…"],
			["DÅ½", "Ç„"],
			
			["dz", "Ç³"],
			["Dz", "Ç²"],
			["DZ", "Ç±"],
		]
		Static double_replacements := [
			["doublepi"   , ezÎ©.doubleReplacer("â„¼", "â„¿")],
			["doublegamma", ezÎ©.doubleReplacer("â„½", "â„¾")],
			["doublesigma", "â…€"],
			
			["doublea", ezÎ©.doubleReplacer("ð•’", "ð”¸")],
			["doubleb", ezÎ©.doubleReplacer("ð•“", "ð”¹")],
			["doublec", ezÎ©.doubleReplacer("ð•”", "â„‚")],
			["doubled", ezÎ©.doubleReplacer("ð••", "ð”»")],
			["doublee", ezÎ©.doubleReplacer("ð•–", "ð”¼")],
			["doublef", ezÎ©.doubleReplacer("ð•—", "ð”½")],
			["doubleg", ezÎ©.doubleReplacer("ð•˜", "ð”¾")],
			["doubleh", ezÎ©.doubleReplacer("ð•™", "â„")],
			["doublei", ezÎ©.doubleReplacer("ð•š", "ð•€")],
			["doublej", ezÎ©.doubleReplacer("ð•›", "ð•")],
			["doublek", ezÎ©.doubleReplacer("ð•œ", "ð•‚")],
			["doublel", ezÎ©.doubleReplacer("ð•", "ð•ƒ")],
			["doublem", ezÎ©.doubleReplacer("ð•ž", "ð•„")],
			["doublen", ezÎ©.doubleReplacer("ð•Ÿ", "â„•")],
			["doubleo", ezÎ©.doubleReplacer("ð• ", "ð•†")],
			["doublep", ezÎ©.doubleReplacer("ð•¡", "â„™")],
			["doubleq", ezÎ©.doubleReplacer("ð•¢", "â„š")],
			["doubler", ezÎ©.doubleReplacer("ð•£", "â„")],
			["doubles", ezÎ©.doubleReplacer("ð•¤", "ð•Š")],
			["doublet", ezÎ©.doubleReplacer("ð•¥", "ð•‹")],
			["doubleu", ezÎ©.doubleReplacer("ð•¦", "ð•Œ")],
			["doublev", ezÎ©.doubleReplacer("ð•§", "ð•")],
			["doublew", ezÎ©.doubleReplacer("ð•¨", "ð•Ž")],
			["doublex", ezÎ©.doubleReplacer("ð•©", "ð•")],
			["doubley", ezÎ©.doubleReplacer("ð•ª", "ð•")],
			["doublez", ezÎ©.doubleReplacer("ð•«", "â„¤")],
			
			["double0", "ðŸ˜"],
			["double1", "ðŸ™"],
			["double2", "ðŸš"],
			["double3", "ðŸ›"],
			["double4", "ðŸœ"],
			["double5", "ðŸ"],
			["double6", "ðŸž"],
			["double7", "ðŸŸ"],
			["double8", "ðŸ "],
			["double9", "ðŸ¡"],
		]
		Static hebrew := [
			["aleph", "â„µ"],
			["bet"  , "â„¶"],
			["gimel", "â„·"],
			["dalet", "â„¸"],
		]
		Static math := [
			;#region compare
				["eq", "â‰¡"],
				["equiv", "â‰¡"],
				["equivalent", "â‰¡"],
				["ne", "â‰ "],
				
				["le", "â‰¤"],
				["ge", "â‰¥"],
			;#endregion
			;#region logic
				["and"      , "âˆ§"],
				["or"       , "âˆ¨"],
				["not"      , "Â¬"],
				
				["forall"   , "âˆ€"],
				["all"      , "âˆ€"],
				["notexists", "âˆ„"],
				["nexists"  , "âˆ„"],
				["exists"   , "âˆƒ"],
				["any"      , "âˆƒ"],
				["nany"     , "âˆƒ"],
			;#endregion
			;#region operators
				["+-", "Â±"],
				["-+", "âˆ“"],
				["cdot", "Â·"],
				["*", "Â·"],
				["sqrt", "âˆš"],
				["cbrt", "âˆ›"],
				["qvrt", "âˆœ"],
			;#endregion
			;#region set
				["notin", "âˆ‰"],
				["nin"  , "âˆ‰"],
				["in"   , "âˆˆ"],
				["cap"         , "âˆ©"],
				["intersect"   , "âˆ©"],
				["intersection", "âˆ©"],
				["cup"         , "âˆª"],
				["union"       , "âˆª"],
				["emptyset", "âŠ˜"],
			;#endregion
			;#region braces
				["ceil"  , ezÎ©.bracketReplacer("âŒˆ", "âŒ‰")],
				["wide"  , ezÎ©.bracketReplacer("âŒˆ", "âŒ‹")],
				["floor" , ezÎ©.bracketReplacer("âŒŠ", "âŒ‹")],
				["trunc" , ezÎ©.bracketReplacer("âŒˆ", "âŒ‹")],
				["braket", ezÎ©.bracketReplacer("âŸ¨", "âŸ©")],
				["ceil(" , "âŒˆ"],
				["ceil)" , "âŒ‰"],
				["wide(" , "âŒŠ"],
				["wide)" , "âŒ‰"],
				["floor(", "âŒŠ"],
				["floor)", "âŒ‹"],
				["trunc(", "âŒˆ"],
				["trunc)", "âŒ‹"],
				["bra", "âŸ¨"],
				["ket", "âŸ©"],
			;#endregion
			["infinity", "âˆž"],
			["inf", "âˆž"],
			["i", "ð•š"],
			["j", "ð•›"],
		
			["angle", "âˆ "],
			["int", "âˆ«"],
			["pardif", "âˆ‚"],
			["sum", "Î£"],
			
			["fax", "â„»"],
			["qed", "âˆŽ"],
			; â„³â„± â„­ â„» 
		]
	;#endregion
	
	Static case_sensitive_replacements := joinSpread(
		ezÎ©.O,
		ezÎ©.diacritics,
	)
	Static case_insensitive_replacements := joinSpread(
		[
			["ez" , "ezÎ©"],
			["ezm", "ezÎ©Manager"],
			["kika", "â€¬"],
			["r", "â“‡"],
			["c", "Â©"],
			["tm", "â„¢"],
		],
		ezÎ©.card_suites,
		ezÎ©.arrows,
		ezÎ©.punctuation,
		ezÎ©.double_replacements,
		ezÎ©.hebrew,
		ezÎ©.math,
	)
}
components.Push(ezÎ©)


#Hotstring EndChars `t
#Hotstring O?


; arrows
	:O:<=>::â‡”
	:O:=>::â‡’
	:O:<=::â‡
	
	:O:<->::â†”
	:O:->::â†’
	:O:<-::â†
; end

; punctuation
	::...::â€¦
; end

; letters
	<^>!r:: SendText("â“‡")
	<^>!c:: SendText("Â©")
; end

; math & logic
	; operators
		:O:+-::Â±
		:O:-+::âˆ“
	; end
; end
	
;